<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>WolfCore Liberty — Registro de Miembros</title>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; }
    body {
      background: linear-gradient(135deg, #0a0a0a 0%, #0b1a3a 100%);
      color: #ffffff;
      font-family: 'Inter', sans-serif;
      min-height: 100vh;
      display: flex;
      justify-content: center;
      align-items: center;
      position: relative;
    }
    .register-container {
      background: rgba(15, 15, 25, 0.8);
      border-radius: 20px;
      padding: 2.5rem;
      width: 90%;
      max-width: 500px;
      border: 1px solid #1e3a5f;
      box-shadow: 0 20px 50px rgba(11, 26, 58, 0.5);
      text-align: center;
    }
    .logo { width: 100px; height: 100px; margin: 0 auto 2rem; border-radius: 8px; border: 2px solid #1e3a5f; background: rgba(11, 26, 58, 0.4); display: flex; align-items: center; justify-content: center; }
    .logo img { width: 80%; height: 80%; object-fit: contain; }
    h1 { font-size: 1.8rem; margin-bottom: 0.5rem; background: linear-gradient(to right, #ffffff, #a0b0d0); -webkit-background-clip: text; background-clip: text; color: transparent; }
    .subtitle { color: #cbd5e1; margin-bottom: 2rem; font-size: 0.95rem; }
    .form-group { margin-bottom: 1.5rem; text-align: left; }
    .form-group label { display: block; margin-bottom: 0.5rem; color: #cbd5e1; font-size: 0.9rem; }
    .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 0.8rem; background: rgba(10, 10, 20, 0.7); border: 1px solid #1e3a5f; border-radius: 8px; color: white; font-family: 'Inter', sans-serif; }
    .register-btn { width: 100%; padding: 0.9rem; background: #0b1a3a; color: white; border: 1px solid #1e3a5f; border-radius: 8px; font-family: 'Inter', sans-serif; font-weight: 600; font-size: 1.1rem; cursor: pointer; transition: all 0.3s ease; }
    .register-btn:hover { background: #1a2a4a; transform: translateY(-2px); }
    .login-link { margin-top: 1.5rem; display: block; color: #4ade80; text-decoration: none; }
    footer { position: absolute; bottom: 20px; text-align: center; width: 100%; color: #cbd5e1; font-size: 0.8rem; }
  </style>
</head>
<body>

  <div class="register-container">
    <div class="logo"><img src="logo-wolfcore.jpg" alt="WolfCore Liberty Logo"></div>
    <h1>Registro de Miembros</h1>
    <p class="subtitle">WolfCore Liberty — Institución Privada del Lobo</p>
    
    <form id="registerForm">
      <div class="form-group">
        <label for="fullName">Nombre Completo</label>
        <input type="text" id="fullName" placeholder="ej: Juan Pérez" required>
      </div>
      <div class="form-group">
        <label for="email">Email Profesional</label>
        <input type="email" id="email" placeholder="ej: juan@empresa.com" required>
      </div>
      <div class="form-group">
        <label for="phone">Teléfono (WhatsApp)</label>
        <input type="tel" id="phone" placeholder="ej: +54 9 11 1234-5678" required>
      </div>
      <div class="form-group">
        <label for="experience">Experiencia en Trading</label>
        <select id="experience" required>
          <option value="">Selecciona tu nivel</option>
          <option value="beginner">Principiante (0-6 meses)</option>
          <option value="intermediate">Intermedio (6-24 meses)</option>
          <option value="advanced">Avanzado (2+ años)</option>
          <option value="professional">Profesional</option>
        </select>
      </div>
      <div class="form-group">
        <label for="motivation">¿Por qué quieres unirte a WolfCore?</label>
        <textarea id="motivation" rows="3" placeholder="Describe tu motivación..." required></textarea>
      </div>
      <button type="submit" class="register-btn">Crear Cuenta y Acceder</button>
    </form>
    <a href="index.html" class="login-link">← Volver al acceso</a>
  </div>

  <footer>© 2026 WolfCore Liberty — Institución Privada del Lobo</footer>

  <!-- EmailJS -->
  <script src="https://cdn.jsdelivr.net/npm/@emailjs/browser@4/dist/email.min.js"></script>
  
  <!-- Firebase CDN -->
  <script src="https://www.gstatic.com/firebasejs/12.8.0/firebase-app-compat.js"></script>
  <script src="https://www.gstatic.com/firebasejs/12.8.0/firebase-firestore-compat.js"></script>
  
  <script>
    // Configuración de Firebase
    const firebaseConfig = {
      apiKey: "AIzaSyD1iqERPDahAc_OtXYnrYJvt6cbwNpu9UE",
      authDomain: "wolfcore-libertyversion1.firebaseapp.com",
      projectId: "wolfcore-libertyversion1",
      storageBucket: "wolfcore-libertyversion1.firebasestorage.app",
      messagingSenderId: "784073773217",
      appId: "1:784073773217:web:26a4cf04d79a14fbf0e0e0"
    };

    // Inicializar Firebase
    firebase.initializeApp(firebaseConfig);
    const db = firebase.firestore();

    // Inicializar EmailJS
    const EMAILJS_PUBLIC_KEY = "6EBT7x4WdOSG96_XD";
    emailjs.init(EMAILJS_PUBLIC_KEY);

    function generateSimplePassword() {
      const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';
      let pwd = '';
      for (let i = 0; i < 8; i++) pwd += chars.charAt(Math.floor(Math.random() * chars.length));
      return pwd;
    }

    document.getElementById('registerForm').addEventListener('submit', function(e) {
      e.preventDefault();
      
      const fullName = document.getElementById('fullName').value.trim();
      const email = document.getElementById('email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      const experience = document.getElementById('experience').value;
      const motivation = document.getElementById('motivation').value.trim();
      
      if (!fullName || !email || !phone || !experience || !motivation) {
        alert('❌ Completa todos los campos.');
        return;
      }
      
      try {
        const btn = document.querySelector('.register-btn');
        btn.textContent = 'Procesando...';
        btn.disabled = true;
        
        const username = email.split('@')[0].toLowerCase().replace(/\./g, '_');
        const password = generateSimplePassword();
        
        // Guardar en Firestore
        db.collection('users').add({
          username, fullName, email, phone, experience, motivation,
          role: 'Miembro', level: 'TRADER', password, active: true,
          createdAt: firebase.firestore.FieldValue.serverTimestamp()
        });

        // GUARDAR EN LOCALSTORAGE PARA LOGIN INMEDIATO
        let users = JSON.parse(localStorage.getItem('wolfcore_users')) || {};
        users[username] = {
          password: password,
          name: fullName,
          role: 'Miembro',
          level: 'TRADER'
        };
        localStorage.setItem('wolfcore_users', JSON.stringify(users));

        // Enviar email al usuario
        emailjs.send("service_wolf6oo", "wolfcore_liberty", {
          to_email: email,
          user_name: fullName,
          username: username,
          password: password,
          login_link: 'https://wolfcore771-lb.github.io/wolfcore-liberty-version2/login.html'
        }).then(() => {
          console.log('Email enviado al usuario');
        }).catch((error) => {
          console.warn('Email falló:', error);
        });
        
        // ACCESO DIRECTO A PLATAFORMA
        localStorage.setItem('wolfcore_user', JSON.stringify({
          username: username,
          name: fullName,
          role: 'Miembro',
          level: 'TRADER'
        }));
        
        btn.textContent = 'Crear Cuenta y Acceder';
        btn.disabled = false;
        
        window.location.href = 'platform.html';
        
      } catch (error) {
        console.error('Error:', error);
        const btn = document.querySelector('.register-btn');
        btn.textContent = 'Crear Cuenta y Acceder';
        btn.disabled = false;
        alert('❌ Error al crear cuenta.');
      }
    });
  </script>

</body>
</html>